<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Memes</title>
    <link rel='stylesheet' href="../public/stylesheets/style.css">
    <script src="../public/scripts/1.js"></script>
    <script src="../public/scripts/html2canvas.js"></script>
</head>
<body>
    <button onclick="generatePressed()" id="generate_b" class="first_state"> generate </button>
    <label id="upload_b" class="button-like first_state">
        <input id="upload_b_button" type="file" accept="image/*" onchange="uploadMeme(this.files[0])">
        upload pic
    </label>

    <div id="div_for_images" class="div_for_images editor-block second_state">
        <div id="meme-container">
            <img alt="mem image" id='mem_image'>
            <div id="draggable" class="draggable">
                <div id="dragger" class="dragger">
                    <img src="../public/images/logo.png" alt="text image" id="text_image" class="text_img">
                </div>
            </div>
        </div>
    </div>

    <div id="app" class="div_for_text_editing editor-block second_state" style="display: none">
        <h1>Create Images from Text</h1>
        <form>
            <label>Enter text:
                <input type="text" id="text-input">
            </label>
            <label>Font:
                <select id="font-select">
                    <option>Tahoma</option>
                    <option>Great Vibes</option>
                    <option>Georgia</option>
                    <option>EB Garamond</option>
                    <option>Jost</option>
                    <option>Pattaya</option>
                    <option>Playfair Display</option>
                    <option>Roboto</option>
                </select>
            </label>
            <button type="button" id="generate-btn">Generate</button>
        </form>
    </div>

    <button onclick="backPressed()" id='back_b' class='second_state'> back </button>
    <button onclick="downloadResult()" id='download_b' class='second_state'> download </button>

    <script src="../public/scripts/index_very_bad.js"></script>
    <script>
      function downloadResult(){
        html2canvas(document.getElementById('meme-container')).then(function(canvas) {
          let a = document.createElement('a');
          let imageType = getImageType();
          console.log(imageType);
          a.href = canvas.toDataURL(imageType, 0.9).replace(imageType, "image/octet-stream");
          a.download = 'your_meme.' + imageType.split('/')[1];
          a.click();
        });
      }
    </script>
</body>
</html>